add_compile_options(-fno-rtti)
add_library(Gate OBJECT
  analyzer/probabilistic_estimate.cpp
  analyzer/simulation_estimator.cpp
  debugger/base_checker.cpp
  debugger/bdd_checker.cpp
  debugger/fraig_checker.cpp
  debugger/rnd_checker.cpp
  debugger/seq_checker.cpp
  model2/cell.cpp
  model2/celltype.cpp
  model2/decomposer/net_decomposer.cpp
  model2/design.cpp
  model2/generator/generator.cpp
  model2/generator/layer_generator.cpp
  model2/generator/matrix_generator.cpp
  model2/link.cpp
  model2/net.cpp
  model2/printer/printer.cpp
  model2/subnet.cpp
  model2/utils/bdd_dnf.cpp
  model2/utils/subnet_checking.cpp
  model2/utils/subnet_to_bdd.cpp
  model2/utils/subnet_truth_table.cpp
  optimizer/area_resynthesizer.cpp
  optimizer/cone_builder.cpp
  optimizer/cut_extractor.cpp
  optimizer/depth_replacer.cpp
  optimizer/depth_subnet_iterator.cpp
  optimizer/mffc.cpp
  optimizer/npn.cpp
  optimizer/npndb.cpp
  optimizer/reconvergence_cut.cpp
  optimizer/resubstitutor.cpp
  optimizer/rewriter.cpp
  optimizer/safe_passer.cpp
  optimizer/synthesis/abc/rwrUtil.c
  optimizer/synthesis/abc_npn4.cpp
  optimizer/synthesis/akers.cpp
  optimizer/synthesis/algebraic_factor.cpp
  optimizer/synthesis/bidecomposition.cpp
  optimizer/synthesis/cascade.cpp
  optimizer/synthesis/de_micheli.cpp
  optimizer/synthesis/dsd_to_subnet.cpp
  optimizer/synthesis/isop.cpp
  optimizer/synthesis/reed_muller.cpp
  optimizer/synthesis/ternary_bi_clique.cpp
  optimizer/synthesis/unitized_table.cpp
  parser/graphml_to_subnet.cpp
  premapper/aigmapper.cpp
  simulator/simulator.cpp
  synthesizer/synthesizer.cpp
  synthesizer/synthesizer_add.cpp
  synthesizer/synthesizer_cmp.cpp
  synthesizer/synthesizer_div.cpp
  synthesizer/synthesizer_mul.cpp
  synthesizer/synthesizer_mux.cpp
  techmapper/assembly.cpp
  techmapper/comb_mapper/comb_mapper.cpp
  techmapper/comb_mapper/cut_based/area_recovery/area_recovery.cpp
  techmapper/comb_mapper/cut_based/cut_based_mapper.cpp
  techmapper/comb_mapper/cut_based/delay_estmt/delay_estmt.cpp
  techmapper/comb_mapper/cut_based/genetic/genetic_mapper.cpp
  techmapper/comb_mapper/cut_based/power_map/power_map.cpp
  techmapper/comb_mapper/cut_based/simple_area/simple_area_mapper.cpp
  techmapper/comb_mapper/cut_based/simple_delay/simple_delay_mapper.cpp
  techmapper/library/cell.cpp
  techmapper/library/cell_db.cpp
  techmapper/library/check_lib/aig/check_lib_for_aig.cpp
  techmapper/seq_mapper/sequential_mapper.cpp
  techmapper/techmapper.cpp
  techmapper/techmapper_wrapper.cpp
  transformer/mutator2/mutator2.cpp
  transformer/mutator2/mutator2_transformer.cpp
  translator/fir/fir_model2.cpp
  translator/verilog/verilog_model2.cpp
  translator/firrtl.cpp
  translator/yosys_converter_firrtl.cpp
  translator/model2.cpp
  translator/yosys_converter_model2.cpp)
add_library(Utopia::Gate ALIAS Gate)

target_include_directories(Gate
  PUBLIC
  ${PROJECT_SOURCE_DIR}/src
  ${PROJECT_SOURCE_DIR}/lib
  ${STACCATO_INCLUDE_DIRS}
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/cudd
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/st
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/mtr
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/epd
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/util
)

target_link_libraries(Gate
  PUBLIC
  ${STACCATO_LIBRARIES}
  MLIRIR
  MLIRSupport
  CIRCTFIRRTL
  CIRCTExportChiselInterface
  CIRCTFIRRTLTransforms
  CIRCTImportFIRFile
  CIRCTTransforms
  MLIRParser
  MLIRRewrite
  MLIRTransformUtils
  MLIRTransforms
  minisat-lib-static
  Cudd::Cudd
  lorina
  readcells
  sqlite3
  CTemplate::nothreads
  Kitty
  Mockturtle
  parallel_hashmap
  Json

  PRIVATE

  Utopia::Util
  CLI
  Yosys::Yosys
  tinyxml2
)
