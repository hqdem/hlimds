add_compile_options(-fno-rtti)
add_library(Gate OBJECT
  analyzer/probabilistic_estimate.cpp
  analyzer/simulation_estimator.cpp
  debugger/base_checker.cpp
  debugger/bdd_checker.cpp
  debugger/sat_checker.cpp
  debugger/encoder.cpp
  debugger/fraig_checker.cpp
  debugger/k_checker.cpp
  debugger/miter.cpp
  debugger/rnd_checker.cpp
  debugger/symexec.cpp
  debugger2/base_checker2.cpp
  debugger2/miter2.cpp
  debugger2/rnd_checker2.cpp
  model/gate.cpp
  model/gnet.cpp
  model/gsymbol.cpp
  model/utils.cpp
  model2/decomposer/net_decomposer.cpp
  model2/cell.cpp
  model2/celltype.cpp
  model2/generator/generator.cpp
  model2/generator/layer_generator.cpp
  model2/generator/matrix_generator.cpp
  model2/link.cpp
  model2/net.cpp
  model2/printer/printer.cpp
  model2/subnet.cpp
  model2/utils/subnet_to_bdd.cpp
  optimizer/cone_visitor.cpp
  optimizer/cuts_finder_visitor.cpp
  optimizer/cut_walker.cpp
  optimizer/database/abc.cpp
  optimizer/database/abc/rwrUtil.c
  optimizer/depth_find_visitor.cpp
  optimizer/links_add_counter.cpp
  optimizer/links_clean_counter.cpp
  optimizer/net_substitute.cpp
  optimizer/npndb.cpp
  optimizer/optimizer.cpp
  optimizer/optimizer_visitor.cpp
  optimizer/resynthesis/akers.cpp
  optimizer/resynthesis/cascade.cpp
  optimizer/resynthesis/reed_muller.cpp
  optimizer/rwdatabase.cpp
  optimizer/rwmanager.cpp
  optimizer/strategy/apply_search_optimizer.cpp
  optimizer/strategy/associative_balancer.cpp
  optimizer/strategy/associative_balance_visitor.cpp
  optimizer/strategy/exhaustive_search_optimizer.cpp
  optimizer/strategy/track_strategy.cpp
  optimizer/substitute_visitor.cpp
  optimizer/targets_list.cpp
  optimizer/tracker_visitor.cpp
  optimizer/truthtable.cpp
  optimizer/util.cpp
  optimizer/walker.cpp
  optimizer2/cone_builder.cpp
  optimizer2/cut_extractor.cpp
  optimizer2/resynthesis/akers.cpp
  optimizer2/resynthesis/dsd_to_subnet.cpp
  optimizer2/resynthesis/bidecomposition.cpp
  optimizer2/resynthesis/cascade.cpp
  optimizer2/resynthesis/de_micheli.cpp
  optimizer2/resynthesis/isop.cpp
  optimizer2/resynthesis/reed_muller.cpp
  optimizer2/resynthesis/ternary_bi_clique.cpp
  optimizer2/resynthesis/unitized_table.cpp
  parser/gate_verilog.cpp
  parser/graphml.cpp
  parser/graphml_to_subnet.cpp
  premapper/aigmapper.cpp
  premapper/migmapper.cpp
  premapper/premapper.cpp
  premapper/xagmapper.cpp
  premapper/xmgmapper.cpp
  printer/dot.cpp
  printer/gate_verilog.cpp
  printer/graphml.cpp
  printer/vcd.cpp
  simulator/simulator.cpp
  techoptimizer/library/cell.cpp
  techoptimizer/cut_based_tech_mapper/strategy/min_delay.cpp
  techoptimizer/cut_based_tech_mapper/cut_based_tech_mapper.cpp
  techoptimizer/cut_based_tech_mapper/tech_map_visitor.cpp
  techoptimizer/tech_optimizer.cpp
  simulator2/simulator.cpp
  transformer/aigmapper.cpp
  transformer/bdd.cpp
  transformer/hmetis.cpp
  transformer/mutator/mutator.cpp
  transformer/mutator/mutator_visitor.cpp
  translator/fir_to_model2/fir_to_model2.cpp
  translator/fir_to_model2/fir_to_model2_wrapper.cpp
  translator/firrtl.cpp
  translator/gate_verilog_translator.cpp
  translator/yosys_converter_firrtl.cpp)
add_library(Utopia::Gate ALIAS Gate)

target_include_directories(Gate
  PUBLIC
  ${PROJECT_SOURCE_DIR}/src
  ${PROJECT_SOURCE_DIR}/lib
  ${STACCATO_INCLUDE_DIRS}
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/cudd
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/st
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/mtr
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/epd
  ${CMAKE_SOURCE_DIR}/lib/bill/lib/cudd/util
)

target_link_libraries(Gate
  PUBLIC
  ${STACCATO_LIBRARIES}
  MLIRIR
  MLIRSupport
  CIRCTFIRRTL
  CIRCTExportChiselInterface
  CIRCTFIRRTLTransforms
  CIRCTImportFIRFile
  CIRCTTransforms
  MLIRParser
  MLIRRewrite
  MLIRTransformUtils
  MLIRTransforms
  minisat-lib-static
  Cudd::Cudd
  lorina
  sqlite3
  CTemplate::nothreads
  Kitty
  Mockturtle
  parallel_hashmap
  Json

  PRIVATE

  Utopia::Util
  CLI
  Yosys::Yosys
  tinyxml2
)
